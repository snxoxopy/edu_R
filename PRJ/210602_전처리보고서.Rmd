---
title: ğŸ¥ì˜í™” ì¶”ì²œì‹œìŠ¤í…œ ì „ì²˜ë¦¬
author: <p align="right"> 2ì¡° </p>
date: <p align="right"> `r format(Sys.Date())` </p>
output:
  html_document:
    theme: cosmo
    highlight: textmate
    toc: yes
    toc_depth: 4
    toc_float: yes
    code_folding: hide
    df_print: paged
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=T, fig.align = "center", message=F, warning=F, fig.height = 3, fig.width = 4, cache=T, dpi = 300, dev = "png")
```

### ë°ì´í„°ìˆ˜ì§‘
```{r í™˜ê²½ì„¤ì •}
rm(list=ls())
setwd("C:\\r_suzin\\PRJ")
#ë¼ì´ë¸ŒëŸ¬ë¦¬ ------------------------
#ì „ì²˜ë¦¬
library(data.table)
library(tidyverse)
library(lubridate)
library(dplyr)
library(naniar)
library(skimr)
#ì‹œê°í™”
library(ggplot2)
library(ggthemes)
library(multilinguer)
library(RColorBrewer)
library(wordcloud)
#ì¶”ì²œì•Œê³ ë¦¬ì¦˜
library(recommenderlab)

#ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° -------------------
movies <- read.csv('./data/movies.csv',header=T)
ratings <- read.csv('./data/ratings.csv',header=T) 
tags <- read.csv('./data/tags.csv',header=T)

# saveRDS(movies, file="./data/movie_data.rds")
# saveRDS(ratings, file="./data/ratings_data.rds")
```

```{r}
setwd("C:\\r_suzin\\PRJ")
m <- read.csv('./data/movies.csv',header=T) # m = movies
r <- read.csv('./data/ratings.csv',header=T) # r = ratings
t <- read.csv('./data/tags.csv',header=T) # t = tags
```

### ê¸°ì´ˆí†µê³„ í™•ì¸: summary()

```{r}
summary(m)
summary(r)
summary(t)
```


### ê¸°ì´ˆí†µê³„ í™•ì¸: barplot()

```{r}
unique(sort(r$rating))
#í‰ì ë°ì´í„°ëŠ” 0 ~ 5.0 ì ê¹Œì§€ 0.5 ë‹¨ìœ„ë¡œ êµ¬ì„±ëœë‹¤.

table_rating <- table(r$rating)
table_rating

r2 <- r %>% group_by(rating) %>% summarise(n=n())
    
ggplot(data=r2 ,aes(x=rating,y=n,fill=n)) +
    geom_bar(stat="identity") +
    ggtitle("í‰ì  ë¶„í¬ë„") +
    xlab("í‰ì ") + ylab("í‰ì íšŸìˆ˜") + theme_minimal() +
    theme(plot.title=element_text(size=20, color="black")) +
    annotate(geom = "rect", xmin = 2.7, xmax =4.3, ymin = 0, ymax = 30000, fill = "blue", alpha = 0.2, colour = "black", lty = 2)

# ê° í‰ì ë“¤ì˜ ë¹ˆë„ìˆ˜ë¥¼ table() ì„ í†µí•´ íŒŒì•…í•œë‹¤.
# ê° í‰ì ë“¤ì˜ ë¹ˆë„ìˆ˜ ë¶„í¬ë¥¼ ì‹œê°í™”í•œ ê²°ê³¼ ëŒ€ë¶€ë¶„ í‰ì ë“¤ì€ 3ì  ì´ìƒì´ë©° 4ì ì¸ ì¼ë°˜ì ì¸ ë°ì´í„°ë¼ê³  í•´ì„ í•  ìˆ˜ ìˆë‹¤.

# ggplot(r,aes(x=rating)) +  
#   geom_bar(fill = c("gray","gray","gray","gray","gray","blue","blue","blue","gray","gray")) +
#   ggtitle("í‰ì  ë¶„í¬ë„") +
#   xlab("í‰ì ") + ylab("í‰ì íšŸìˆ˜") + theme_bw() +
#   theme(plot.title=element_text(size=20, colour = "black"))

```

### í‰ì  Boxplot
```{r}
r_rmna <- r %>% filter(!is.na(rating))

ggplot(r_rmna) +
  geom_boxplot(aes(x = rating), fill="blue", alpha = 0.3, outlier.color = 'blue', outlier.size = 4) +
  theme_minimal() +
  ggtitle("í‰ì  Boxplot") +
  xlab("") + ylab("") +
  theme(plot.title=element_text(size=20, color="black"))

summary(r$rating)

# ëª©ì : ìˆ˜ì§‘í•œ í‰ì ì˜ ì´ìƒì¹˜ í™•ì¸
# 
# ë°©ë²•: boxplot
# 
# ë¶„ì„ê²°ê³¼:
# 
# 1) íšë“í•œ í‰ì ì˜ ì¤‘ì•™ê°’ì€ ì•½3.5
# 2) 3Q: í‰ì ì´ ì•½ 4ì ì´ìƒì´ë©´ ìƒìœ„ 25%ë‚´ì— í¬í•¨ëœë‹¤.
# 3) 1Q: í‰ì ì´ ì•½ 3ì ì´í•˜ì´ë©´ í•˜ìœ„ 25%ë‚´ì— í¬í•¨ëœë‹¤.
# 4) 3~4ì ëŒ€ì˜ í‰ì ë“¤ì€ íšë“í•œ í‰ì ë“¤ì˜ ì•½ 60%ì— í•´ë‹¹í•œë‹¤.
# 5) ì´ìƒì¹˜: ì•½ 1.5ì´í•˜ì˜ í‰ì ë“¤ì€ í‰ì ë“¤ ë¶„í¬ ì•½ 99%ì´ë‚´ í¬í•¨ë˜ì§€ ëª»í•œë‹¤.
# 6) ì´ìƒì¹˜ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ë¥¼ í™•ì¸í•œë‹¤.
# 
# ê²°ë¡ :
# 
# - ì´ìƒì¹˜ì— í•´ë‹¹í•˜ëŠ” ì˜í™”ë¥¼ ì¬ ê²€í† í•œë‹¤. 3~4ì ëŒ€ í‰ì ì„ ê°–ëŠ” ì˜í™”ë“¤ ì¤‘ ìµœì €/ìµœê³ ì ì„ í™•ì¸í•´ë³¸ë‹¤.
# 
# - ì˜í™” ì¶”ì²œì˜ ëª©í‘œëŠ” ì‚¬ìš©ìê°€ ìŠ¤ìŠ¤ë¡œ íŒŒì•…í•˜ì§€ ëª»í•œ ê²ƒì„ ì¶”ì²œí•´ì£¼ëŠ” ê²ƒì´ë‹¤.
# 
# - ìœ„ ê²°ê³¼ì—ì„œ ì´ìƒì¹˜ëŠ” ì¼ë°˜ì ì¸ ì„±í–¥ì„ íŒŒì•…í•˜ëŠ”ë° ì˜¤ì°¨ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.
# 
# - ì´ìƒì¹˜ ì²˜ë¦¬ì „ í•´ë‹¹ ì˜í™”ê°€ ë¬´ì—‡ì¸ì§€ ì°¾ì•„ë³¸ë‹¤. 
# 
# - ê°œì¸ì˜ í‰ì ì´ê¸° ë•Œë¬¸ì— ìƒ˜í”Œë§í•  ê²ƒì¸ì§€ ì œê±°í•  ê²ƒì¸ì§€ ì˜ë…¼í•´ë³¸ë‹¤.
```

### ì˜í™”ë¶„í¬ë„
```{r}
##
r2<-r %>% group_by(movieId) %>% summarise(mean_rating = mean(rating), n=n())

ggplot(data=r2,aes(y=r2$mean_rating)) + geom_boxplot() + 
  ggtitle("í‰ì  Boxplot") +
  xlab("") + ylab("") + theme_minimal() +
  theme(plot.title=element_text(size=20, color="black")) +
  coord_flip()

##
df_ratings_means <- r %>% 
  group_by(movieId) %>% 
  summarise(mean_rating = mean(rating), n=n()) %>% 
  arrange(desc(n))

ggplot()+geom_point(mapping=aes(x=mean_rating, y=n), data=df_ratings_means, color = 'blue') + annotate(geom = "rect", xmin = 1.5, xmax = 4.5, ymin = 25, ymax = 350, fill = "blue", alpha = 0.1, colour = "black", lty = 2) + theme_minimal() +
  ggtitle("ì˜í™”ë¶„í¬ë„") +
  xlab("í‰ê·  í‰ì ") + ylab("í‰ê°€ íšŸìˆ˜") +
  theme(plot.title=element_text(size=20, color="black"))

```
>ì˜í™” ë³„ë¡œ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ê³  ì˜í™”ë³„ í‰ì ì„ êµ¬í•œë‹¤. êµ¬í•œ ì˜í™”ë³„ í‰ì ì„ ê¸°ë°˜ìœ¼ë¡œ Boxplotì„ ë§Œë“ ë‹¤. ëŒ€ë¶€ë¶„ì˜ ì˜í™” í‰ì ì´ 3~4ì  ì‚¬ì´ì— ì¡´ì¬í•˜ì§€ë§Œ ì´ìƒì¹˜ë¡œ ë‚˜ì˜¤ëŠ” ë‚®ì€ í‰ì ì˜ ì˜í™”ë“¤ì„ ì°¾ì•„ ê·¸ ì˜í™”ë¥¼ ë¶„ì„í•´ë³¸ë‹¤.(ex. ëª‡ ëª…ì˜ ì‚¬ëŒì´ í‰ê°€ í–ˆëŠ”ì§€ ë“±ë“±)


>ê°ì˜í™”ì˜ í‰ê·  í‰ì ì„ êµ¬í•˜ê³  í‰ê·  í‰ì ì— ëŒ€í•´ ì–´ë– í•œ ì˜í™”ë“¤ì´ ë§ì´ ì¡°íšŒë˜ì—ˆëŠ”ì§€ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. ì‚¬ëŒë“¤ì´ ë§ì´ ì¡°íšŒí•œ ì˜í™”ë“¤ì€ ëŒ€ë¶€ë¶„ 3 ~ 4 ì  ì‚¬ì´ì— ë§ì´ ë¶„í¬ë˜ì–´ ìˆê³  ê·¹ë‹¨ê°’ì¸ 0, 5 ì ì€ ì†Œìˆ˜ì˜ ì‚¬ëŒë“¤ì—ê²Œ í‰ê°€ ë°›ì•˜ë‹¤ê³  íŒë‹¨ í•  ìˆ˜ë„ ìˆë‹¤.

  => ê·¹ë‹¨ ê°’ìœ¼ë¡œ í‰ê°€ëœ ì˜í™”ë“¤ì€ ì œì™¸í•  ìˆ˜ ìˆëŠ”ì§€??


>í•´ë‹¹ ë°•ìŠ¤ ë¶€ë¶„ì€ ì—¬ëŸ¬ì‚¬ìš©ìë“¤ì—ê²Œ í‰ê°€íšŸìˆ˜(25íšŒ ì´ìƒ)ë¥¼ ë°›ì€ ì˜í™”ë“¤ì˜ í‰ê· ì ì¸ í‰ì  ì§€í‘œë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì´ë¥¼ í†µí•´ ì´ìƒì¹˜ë¡œ ë°œê²¬ë˜ëŠ” í‰ê· í‰ì  1ì´í•˜, 5ì  ì´ë©´ì„œ í‰ê°€íšŸìˆ˜ 25íšŒ ë¯¸ë§Œì¸ ì˜í™”ë“¤ì€ ì†Œìˆ˜ì˜ ì‚¬ëŒë“¤ì˜ ì£¼ê´€ì´ ë“¤ì–´ê°„ ê²ƒìœ¼ë¡œ íŒë‹¨í•˜ì—¬ ì•Œê³ ë¦¬ì¦˜ ëª¨ë¸ë§ì— ê³µì •í•˜ì§€ ì•Šì€ ë°ì´í„°ë¡œ íŒë‹¨í•œë‹¤..


### 100ëª… ë¯¸ë§Œ ì˜í™”ë¶„í¬ë„
```{r}
down <-  subset(df_ratings_means,n <=100)

ggplot()+
  geom_point(mapping=aes(x=mean_rating, y=n), data=down, color = 'blue') + 
  annotate(geom = "rect", xmin = 1.5, xmax = 4.5, ymin = 25, 
           ymax = 110, fill = "purple", alpha = 0.1, colour = "black", lty = 2) +
  ggtitle("100ëª… ë¯¸ë§Œ ì˜í™”ë¶„í¬ë„") +
  xlab("í‰ê·  í‰ì ") + ylab("í‰ê°€ íšŸìˆ˜") +
  theme(plot.title=element_text(size=20, color="black")) +
  theme_minimal()

# ë§ì€ ë°ì´í„°ê°€ ë¶„í¬í•˜ê³  ìˆëŠ” í‰ê°€íšŸìˆ˜ 100ë¯¸ë§Œì¸ ì˜í™”ë“¤ì˜ ë¶„í¬ë¡œë§Œ ì¶•ì†Œì‹œí‚¨ ì‚°í¬ë„. 
# 
# => ìœ„ ì‚°í¬ë„ë¥¼ í†µí•´ í‰ê°€ íšŸìˆ˜ë¥¼ 25íšŒ ì´ìƒ ë°›ì€ ë°ì´í„°ë“¤ì´ ì¼ë¶€ ì†Œìˆ˜ì˜ ê·¹ë‹¨í‰ê°€ ì˜í™”ê°€ ì•„ë‹Œ ë°ì´í„°ë¡œ ì‚¬ìš©í•˜ëŠ”ê²ƒìœ¼ë¡œ íŒë‹¨

```

### ì˜í™” ì¡°íšŒìˆ˜ 
```{r}
df_ratings_means <- r %>% 
  group_by(movieId) %>% 
  summarise(mean_rating = mean(rating), n=n()) %>% 
  arrange(desc(n)) %>% head(10)

mybar = barplot(df_ratings_means$n ~ df_ratings_means$movieId, col="steelblue",
        names.arg=c('í¬ë ˆìŠ¤íŠ¸ ê²€í”„','ì‡¼ìƒí¬ íƒˆì¶œ','í„í”„ í”½ì…˜','ì–‘ë“¤ì˜ ì¹¨ë¬µ','ë§¤íŠ¸ë¦­ìŠ¤','ìŠ¤íƒ€ì›Œì¦ˆ','ì¥¬ë¼ê¸°ê³µì›','ë¸Œë ˆì´ë¸Œí•˜íŠ¸','í„°ë¯¸ë„¤ì´í„°2','ì‰°ë“¤ëŸ¬ ë¦¬ìŠ¤íŠ¸'),
        main="ì‚¬ìš©ì í‰ê°€ ì˜í™” Top10", xlab="", ylab="", las=2, horiz=T,
        cex.names=.59)

# ì› ë°ì´í„°ì—ì„œ userë“¤(610ëª…) ì´ ê°€ì¥ ë§ì´ ì¡°íšŒ, í‰ê°€í•œ ì˜í™” ìƒìœ„ 10ê°œì˜ ë­í¬ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
# 
# - movieId : 356 = Forrest Gump (1994)  í¬ë ˆìŠ¤íŠ¸ ê²€í”„
# - movieId : 318 = Shawshank Redemption, The (1994)  ì‡¼ìƒí¬ íƒˆì¶œ
# - movieId : 296 = Pulp Fiction (1994) í„í”„ í”½ì…˜
# - movieId : 593 = Silence of the Lambs, The (1991) ì–‘ë“¤ì˜ ì¹¨ë¬µ
# - movieId : 2571 = Matrix, The (1999) ë§¤íŠ¸ë¦­ìŠ¤
# - movieId : 260 = Star Wars: Episode IV - A New Hope (1977) ìŠ¤íƒ€ì›Œì¦ˆ
# - movieId : 480 = Jurassic Park (1993) ì¥¬ë¼ê¸°ê³µì› 
# - movieId : 110 = Braveheart (1995) ë¸Œë ˆì´ë¸Œí•˜íŠ¸
# - movieId : 589 = Terminator 2: Judgment Day (1991) í„°ë¯¸ë„¤ì´í„°2
# - movieId : 527 = Schindler's List (1993) ì‰°ë“¤ëŸ¬ ë¦¬ìŠ¤íŠ¸ 
# 
# ìƒìœ„ 1,2,3ìˆœìœ„ ë­í¬ëŠ” ì‚¬ìš©ì ì ˆë°˜ì´ìƒ (300ëª…) ì¡°íšŒ,í‰ê°€í•œ ì˜í™”ì¸ ì ì„ ì•Œ ìˆ˜ ìˆë‹¤.
```

### Tag í…ìŠ¤íŠ¸ë§ˆì´ë‹
```{r}
t2 <- tolower(t$tag)
#sort(t2, decreasing = T) #ì •ë ¬
t3 <- table(t2)
palete <- brewer.pal(7,"Set3")
wordcloud(names(t3), freq=t3, scale=c(10,1), rot.per=0.1, min.freq=15,
          random.order=F, random.color=T, colors=palete)

# ì‚¬ìš©ìë“¤ì´ ì˜í™”ë³„ë¡œ ë‚¨ê¸´ íƒœê·¸ë“¤ì„ í…ìŠ¤íŠ¸ë§ˆì´ë‹í•œ ê²°ê³¼ì´ë‹¤. ê°€ì¥ ë§ì€ tag commentë¥¼ ë‚¨ê¸´ keywordë“¤ì€ atmospheric, superhero, funny, thought-provoking, surreal ì •ë„ì´ë‹¤.
```

